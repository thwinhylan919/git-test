<div data-bind="template : $component.getTemplate(), data:$data"></div>
<script type="text/html" id="corpTemplate_eligibility">
    <div class="oj-panel calculator">
        <div class="oj-flex oj-flex-items-pad">
            <div class="oj-flex-item">
                <h3 class="calculator__subheading" data-bind="text:nls.loanEligibilityCalculator.pageHeader">
                </h3>
            </div>
        </div>
        <!-- ko if:dataLoaded() -->
        <div class="oj-flex oj-flex-items-pad oj-sm-flex-items-initial oj-sm-justify-content-space-between calculator__slider">
            <div class="oj-flex-item oj-sm-12 oj-md-6">
                <oj-label :for="[['monthlyIncome'+($baseModel.incrementIdCount())]]">
                    <span data-bind="text:nls.loanEligibilityCalculator.avgMonthlyInc"></span>
                </oj-label>
                <div id="monthlyIncome-slider-container">
                    <oj-slider value="{{$component.sliderData['GROSSMONTHLYINCOME'].value}}" min="[[$component.sliderData['GROSSMONTHLYINCOME'].min]]" max="[[$component.sliderData['GROSSMONTHLYINCOME'].max]]" step="[[$component.sliderData['GROSSMONTHLYINCOME'].step]]" data-bind="attr:{id:'monthlyIncome'+ $baseModel.incrementIdCount(),'aria-label':$component.sliderData['GROSSMONTHLYINCOME'].value}">
                    </oj-slider>
                </div>
            </div>
            <div class="oj-flex-item oj-sm-12 oj-md-3">
                <oj-label class="hide-label" :for="[['monthlyIncome'+($baseModel.incrementIdCount())]]">
                    <span data-bind="text:nls.loanEligibilityCalculator.avgMonthlyInc"></span>
                </oj-label>
                <oj-input-text class=""  required :maxlength="[[7]]" :id="[['monthlyIncome'+($baseModel.currentIdCount())]]" converter="[[{type:'number',options:{ style:'currency',currency:typeof ko.utils.unwrapObservable(currency) ==='string'? ko.utils.unwrapObservable(currency):'',currencyDisplay:'symbol',minimumIntegerDigits:4}}]]"
                    validators="[[$baseModel.getValidator('DECIMALS',$component.nls.validate.amount,{type:'numberRange',options:{min:$component.sliderData['GROSSMONTHLYINCOME'].min,max:$component.sliderData['GROSSMONTHLYINCOME'].max}})]]" value="{{sliderData['GROSSMONTHLYINCOME'].value}}"></oj-input-text>
            </div>
        </div>

        <div class="oj-flex oj-flex-items-pad oj-sm-flex-items-initial oj-sm-justify-content-space-between calculator__slider">
            <div class="oj-flex-item oj-sm-12 oj-md-6">
                <oj-label :for="[['amountExp'+($baseModel.incrementIdCount())]]">
                    <span data-bind="text:nls.loanEligibilityCalculator.avgMonthlyExp"></span>
                </oj-label>
                <div id="monthlyExpenses-slider-container">
                    <oj-slider value="{{$component.sliderData['MONTHLYEXPENSES'].value}}" min="[[$component.sliderData['MONTHLYEXPENSES'].min]]" max="[[$component.sliderData['MONTHLYEXPENSES'].max]]" step="[[$component.sliderData['MONTHLYEXPENSES'].step]]" data-bind="attr:{id:'amountExp'+ $baseModel.incrementIdCount(),'aria-label':$component.sliderData['MONTHLYEXPENSES'].value}">
                    </oj-slider>
                </div>
            </div>
            <oj-label class="hide-label" :for="[['amountExp'+($baseModel.incrementIdCount())]]">
                <span data-bind="text:$component.nls.validate.amount"></span>
            </oj-label>
            <div class="oj-flex-item oj-sm-12 oj-md-3">
                <oj-input-text class=""  required :maxlength="[[7]]" :id="[['amountExp'+($baseModel.currentIdCount())]]" converter="[[{type:'number',options:{ style:'currency',currency:typeof ko.utils.unwrapObservable(currency) ==='string'? ko.utils.unwrapObservable(currency):'',currencyDisplay:'symbol'}}]]"
                    validators="[[$baseModel.getValidator('DECIMALS',$component.nls.validate.amount,{type:'numberRange',options:{min:$component.sliderData['MONTHLYEXPENSES'].min,max:$component.sliderData['MONTHLYEXPENSES'].max}})]]" value="{{sliderData['MONTHLYEXPENSES'].value}}"></oj-input-text>
            </div>
        </div>

        <div class="oj-flex oj-flex-items-pad oj-sm-flex-items-initial oj-sm-justify-content-space-between calculator__slider">
            <div class="oj-flex-item oj-sm-12 oj-md-5">
                <oj-label :for="[['inputTenure'+($baseModel.incrementIdCount())]]">
                    <span data-bind="text:nls.loanEligibilityCalculator.months"></span>
                </oj-label>
                <div id="frequency-slider-container">
                    <oj-slider value="{{$component.sliderData['TENURE'].value}}" min="[[$component.sliderData['TENURE'].min]]" max="[[$component.sliderData['TENURE'].max]]" step="[[$component.sliderData['TENURE'].step]]" data-bind="attr:{id:'inputTenure'+ $baseModel.incrementIdCount(),'aria-label':$component.sliderData['TENURE'].value}">
                    </oj-slider>
                </div>
            </div>
            <oj-label class="hide-label" :for="[['inputTenure'+($baseModel.incrementIdCount())]]" :text="[[nls.loanEligibilityCalculator.months]]">
            </oj-label>
            <div class="oj-flex-item oj-sm-12 oj-md-1">

                <oj-input-text
                converter="[[{type:'number'}]]"  required :maxlength="[[2]]" :id="[['inputTenure'+($baseModel.currentIdCount())]]" validators="[[$baseModel.getValidator('TENURE_MONTHS', {type: 'numberRange', options: {
                    min: $component.sliderData['TENURE'].min,
                    max: $component.sliderData['TENURE'].max
                  }})]]" value="{{sliderData['TENURE'].value}}"
                  display-options='{"messages": "notewindow"}'></oj-input-text>
            </div>
            <div class="oj-flex-item oj-sm-12 oj-md-3">
                <oj-label :for="[['text-input'+($baseModel.incrementIdCount())]]">
                    <span data-bind="text:nls.loanEligibilityCalculator.interest"></span>
                </oj-label>
                <div id="interestRate-slider-container">
                    <oj-slider value="{{$component.sliderData['INTERESTRATE'].value}}" min="[[$component.sliderData['INTERESTRATE'].min]]" max="[[$component.sliderData['INTERESTRATE'].max]]" step="[[$component.sliderData['INTERESTRATE'].step]]" data-bind="attr:{id:'text-input'+ $baseModel.incrementIdCount(),'aria-label':$component.sliderData['INTERESTRATE'].value}">
                    </oj-slider>
                </div>
            </div>
            <oj-label class="hide-label" :for="[['text-input'+($baseModel.incrementIdCount())]]">
                <span data-bind="text:$component.nls.validate.emptyInterest"></span>
            </oj-label>
            <div class="oj-flex-item oj-sm-12 oj-md-2 interest-rates">
                <oj-input-text  :id="[['text-input'+($baseModel.currentIdCount())]]" converter="[[{
                                                type:'number',options:{
          style:'percent',maximumFractionDigits:2,useGrouping:false}}]]" validators="[[$baseModel.getValidator('DECIMALS',$component.nls.validate.emptyInterest,{type:'numberRange',options:{min:$component.sliderData['INTERESTRATE'].min,max:$component.sliderData['INTERESTRATE'].max}})]]"
                    value="{{sliderData['INTERESTRATE'].value}}"></oj-input-text>
            </div>
        </div>

        <div class="oj-flex oj-flex-items-pad">
            <div class="oj-flex-item oj-sm-12 oj-lg-4 button-container calculateEligibilityButton">
                <oj-button class="action-button-primary" on-click="[[calculateLoanEligibility]]">
                    <span data-bind="text:nls.loanEligibilityCalculator.calculate"></span>
                </oj-button>
            </div>
            <!-- ko if:dataLoaded1() -->

            <div class="oj-flex-item oj-sm-6 oj-lg-4 calculator__eligibleAmount">
                <div data-bind="text:nls.loanEligibilityCalculator.eligibleAmount"></div>
                <div class="highlight-text" data-bind="text:$formatter.formatCurrency($component.response().amount.amount,$component.response().amount.currency)">
                </div>
            </div>

            <div class="oj-flex-item oj-sm-6 oj-lg-4 calculator__avgInstallment">
                <div data-bind="text:nls.loanEligibilityCalculator.avgInstallment"></div>
                <div data-bind="text : $baseModel.format(nls.loanEligibilityCalculator.perMonthAmount,{amount:$formatter.formatCurrency($component.response().monthlyInstallmentAmount.amount,$component.response().monthlyInstallmentAmount.currency)})"></div>
            </div>

            <!-- /ko -->
        </div>
        <!-- /ko -->
    </div>
</script>

<script type="text/html" id="retTemplate_eligibility">
    <!-- ko if:dataLoaded() -->
    <div class="form-main-container calculator">
        <div class="oj-flex oj-flex-items-pad oj-sm-flex-items-initial oj-sm-justify-content-space-between">
            <div class="oj-flex-item oj-sm-12 oj-md-6 oj-lg-4">
                <oj-validation-group id="calculateLoanEligibility" valid="{{validationTracker}}">
                    <page-section params="baseModel : $baseModel, rootModel : $data, heading : '' ">

                        <div class="oj-flex oj-flex-items-pad calculator__header">
                            <div class="oj-flex-item oj-sm-12" data-bind="text:$component.nls.loanEligibilityCalculator.header">
                            </div>
                        </div>

                        <div data-bind="component: {
              name: 'amount-input',
              params: {
              amount :monthlyIncome,
              label :$component.nls.loanEligibilityCalculator.monthlyIncome,
              currency: typeof ko.utils.unwrapObservable(currency) === 'string' ? ko.utils.unwrapObservable(currency) : '',
              validator:$component.validationTracker,
              isMandatory:true,
              rootId:'inputIncome',
            rootClass :'form-input'}
            }">
                        </div>

                        <div data-bind="component: {
              name: 'amount-input', params: {
              amount :monthlyExpenses,
              label :$component.nls.loanEligibilityCalculator.monthlyExpenses,
                currency: typeof ko.utils.unwrapObservable(currency) === 'string' ? ko.utils.unwrapObservable(currency) : '',
              validator:$component.validationTracker,
              isMandatory:true,
              rootId:'inputExpenses',
            rootClass :'form-input'}
              }">
                        </div>

                        <div class="oj-flex oj-flex-items-pad">
                            <div class="oj-flex-item oj-sm-12 oj-md-12 oj-lg-12">
                                <oj-label>
                                    <span data-bind="text:$component.nls.loanEligibilityCalculator.for"></span>
                                </oj-label>
                            </div>

                            <div class="oj-flex-item oj-sm-4 oj-md-3 oj-lg-4">
                                <oj-label class="hide-label" :for="[['inputTenure'+($baseModel.incrementIdCount())]]">
                                    <span data-bind="text:$component.nls.loanEligibilityCalculator.tenureValidation"></span>
                                </oj-label>
                                <oj-input-text class="tenure" required :maxlength="[[2]]" :id="[['inputTenure'+($baseModel.currentIdCount())]]" validators="[[$baseModel.getValidator('TENURE_YEARS', {type: 'numberRange', options: {
                    min: $component.sliderData['TENURE'].min,
                    max: $component.sliderData['TENURE'].max
                  }})]]" value="{{tenure}}"></oj-input-text>
                            </div>
                        </div>

                        <div class="oj-flex oj-flex-items-pad calculator__interest calculator-interest">
                            <div class="oj-flex-item oj-sm-4 oj-md-4 oj-lg-3 calculator-interest__text">
                                <oj-label class="" for="inputInterest">
                                    <span data-bind="text:$component.nls.loanEligibilityCalculator.interestRate"></span>
                                </oj-label>
                            </div>

                            <a href="#" data-bind="click:leftClick">
                                <img data-bind="attr:{alt:$component.nls.loanEligibilityCalculator.reduceInterest,title:$component.nls.loanEligibilityCalculator.reduceInterestTitle},loadImage:'calculator/left-arrow.svg'" id="left" class="calculator__image">
                            </a>

                            <div class="calculator-interest__value">
                                <oj-input-text  id="inputInterest" required converter="[[{
                  type:'number',options:{
                  style:'percent',maximumFractionDigits:2,useGrouping:false}}]]" validators="[[$baseModel.getValidator('DECIMALS',$component.nls.validate.emptyInterest,{type:'numberRange',options:{min:$component.sliderData['INTERESTRATE'].min,max:$component.sliderData['INTERESTRATE'].max}})]]"
                                    value="{{interest}}"></oj-input-text>
                            </div>
                            <a href="#" data-bind="click:rightClick">
                                <img data-bind="attr:{alt:$component.nls.loanEligibilityCalculator.increaseInterest,title:$component.nls.loanEligibilityCalculator.increaseInterestTitle},loadImage:'calculator/right-arrow.svg'" id="right" class="calculator__image">
                            </a>
                        </div>

                        <!-- ko if:response() -->
                        <div class="oj-flex oj-flex-items-pad center calculator__response calculator-response">
                            <div class="oj-flex-item oj-sm-12 calculator-response__text" data-bind="html:$baseModel.format($component.nls.loanEligibilityCalculator.loanOf, {calculatedAmount : $formatter.formatCurrency(response().amount.amount,response().amount.currency)})">
                            </div>
                            <div class="oj-flex-item oj-sm-12 calculator-response__text" data-bind="html:$baseModel.format($component.nls.loanEligibilityCalculator.avgInstallmentValue,{value:$formatter.formatCurrency(response().monthlyInstallmentAmount.amount,response().monthlyInstallmentAmount.currency)})"></div>
                        </div>
                        <!-- /ko -->
                    </page-section>
                </oj-validation-group>
                <div class="oj-flex oj-flex-items-pad button-container">
                    <oj-button class="action-button-primary " on-click="[[calculateLoan]]">
                        <span slot="startIcon" class="icons icon-foreign-exchange"></span>
                        <span data-bind="text:nls.loanEligibilityCalculator.calculate"></span>
                    </oj-button>
                    <!-- ko ifnot: $dashboard.userData && $dashboard.userData.userProfile -->
                    <oj-button class="action-button-tertiary" on-click="[[$dashboard.hideDetails]]">
                        <span data-bind="text:$component.nls.loanEligibilityCalculator.back"></span>
                    </oj-button>
                    <!-- /ko -->
                </div>
            </div>

            <div class="oj-flex-item oj-lg-4 oj-sm-only-hide oj-md-only-hide">
                <help params="baseModel : $baseModel, rootModel : $component, transaction: 'loan-eligibility-calculator'"></help>
            </div>

        </div>
    </div>
    <!-- /ko -->
</script>
